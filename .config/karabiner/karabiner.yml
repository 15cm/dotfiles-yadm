_anchors:
  modifiers_filter_any: &modifiers_filter_any
    optional:
      - any
  modifiers_filter_not_fn: &modifiers_filter_not_fn
    optional:
      - control
      - option
      - shift
      - command
  modifiers_filter_not_shift: &modifiers_filter_not_shift
    optional:
      - control
      - option
      - command
  modifiers_filter_fn: &modifiers_filter_fn
    mandatory:
      - fn
  modifiers_filter_control_command: &modifiers_filter_control_command
    mandatory:
      - control
      - command
  modifiers_filter_option_shift: &modifiers_filter_option_shift
    mandatory:
      - shift
      - option
  # --------------------- layers ---------------------
  # layer 1
  # space
  modifiers_layer1: &modifiers_layer1
    - command
    - shift
    - option
  # layer 2
  # tab
  modifiers_layer2: &modifiers_layer2
    - command
    - option
    - control
  # layer 3
  # grave_accent_and_tilde
  modifiers_layer3: &modifiers_layer3
    - control
    - shift
    - command
  cond_layer0: &cond_layer0
    name: layer
    type: variable_if
    value: 0
  cond_layer1: &cond_layer1
    name: layer
    type: variable_if
    value: 1
  cond_layer2: &cond_layer2
    name: layer
    type: variable_if
    value: 2
  cond_layer3: &cond_layer3
    name: layer
    type: variable_if
    value: 3
  # _____________________ layers _____________________
  conditions_device_internal: &conditions_device_internal
    - type: device_if
      identifiers:
        - vendor_id: 1452
        - product_id: 610
  conditions_device_external: &conditions_device_external
    - type: device_unless
      identifiers:
        - vendor_id: 1452
        - product_id: 610
  cond_input_en: &cond_input_en
    type: input_source_if
    input_sources:
      - language: en
  cond_input_zh: &cond_input_zh
    type: input_source_if
    input_sources:
      - language: zh-Hans
  cond_input_ja: &cond_input_ja
    type: input_source_if
    input_sources:
      - language: ja
  conditions_frontmost_not_partial_emacs: &conditions_frontmost_not_partial_emacs
    - bundle_identifiers:
        - '^org\.gnu\.Emacs.*'
        - '^com\.googlecode\.iterm2.*'
        - '^io\.alacritty.*'
        - '^com\.apple\.com\.Terminal.*'
        - '^com\.jetbrains\..*'
        - '^com\.apple\.dt\.Xcode.*'
      type: frontmost_application_unless
  conditions_frontmost_not_whole_emacs: &conditions_frontmost_not_whole_emacs
    - bundle_identifiers:
        - '^org\.gnu\.Emacs.*'
        - '^com\.googlecode\.iterm2.*'
        - '^io\.alacritty.*'
        - '^com\.apple\.com\.Terminal.*'
      type: frontmost_application_unless
  conditions_frontmost_need_home_end: &conditions_frontmost_need_home_end
    - bundle_identifiers:
      - '^org\.telegram\.desktop.*'
      - '^com\.microsoft\..*'
      type: frontmost_application_if
  conditions_frontmost_not_emacs: &conditions_frontmost_not_emacs
    - bundle_identifiers:
        - '^org\.gnu\.Emacs.*'
      type: frontmost_application_unless

global:
  check_for_updates_on_startup: true
  show_in_menu_bar: false
  show_profile_name_in_menu_bar: false
profiles:
- complex_modifications:
    parameters:
      basic.to_if_alone_timeout_milliseconds: 500
    rules:
      - manipulators:
        - description: '(internal) fn-caps_lock: caps_lock'
          conditions: *conditions_device_internal
          from:
            key_code: caps_lock
            modifiers: *modifiers_filter_fn
          to:
            - key_code: caps_lock
          type: basic
        - description: '(interval) caps_lock: escape, left_control'
          conditions: *conditions_device_internal
          from:
            key_code: caps_lock
            modifiers: *modifiers_filter_not_fn
          to:
            - key_code: left_control
          to_if_alone:
            - key_code: escape
          type: basic
        # Emacs bindings
        - description: 'control-f: right_arrow'
          conditions: *conditions_frontmost_not_partial_emacs
          from:
            key_code: f
            modifiers:
              mandatory:
                - control
          to:
            - key_code: right_arrow
          type: basic
        - description: 'control-b: left_arrow'
          conditions: *conditions_frontmost_not_partial_emacs
          from:
            key_code: b
            modifiers:
              mandatory:
                - control
          to:
            - key_code: left_arrow
          type: basic
        - description: 'control-n: down_arrow'
          conditions: *conditions_frontmost_not_whole_emacs
          from:
            key_code: n
            modifiers:
              mandatory:
                - control
          to:
            - key_code: down_arrow
          type: basic
        - description: 'control-p: up_arrow'
          conditions: *conditions_frontmost_not_whole_emacs
          from:
            key_code: p
            modifiers:
              mandatory:
                - control
          to:
            - key_code: up_arrow
          type: basic
        - description: 'control-a: begin of line'
          conditions: *conditions_frontmost_need_home_end
          from:
            key_code: a
            modifiers:
              mandatory:
                - control
          to:
            - key_code: home
          type: basic
        - description: 'control-e: end'
          conditions: *conditions_frontmost_need_home_end
          from:
            key_code: e
            modifiers:
              mandatory:
                - control
          to:
            - key_code: end
          type: basic
        - description: 'control-h: delete'
          from:
            key_code: h
            modifiers:
              mandatory:
                - control
          to:
            - key_code: delete_or_backspace
          type: basic
        - description: 'control-d: delete_forward'
          conditions: *conditions_frontmost_not_partial_emacs
          from:
            key_code: d
            modifiers:
              mandatory:
                - control
          to:
            - key_code: delete_forward
          type: basic
        - description: 'control-k: kill to end'
          conditions:  *conditions_frontmost_need_home_end
          from:
            key_code: k
            modifiers:
              mandatory:
                - control
          to:
            - key_code: end
              modifiers:
                - fn
                - shift
            - key_code: delete_or_backspace
          type: basic
        - description: 'option-b: back a word'
          conditions: *conditions_frontmost_not_whole_emacs
          from:
            key_code: b
            modifiers:
              mandatory:
                - option
          to:
            - key_code: left_arrow
              modifiers:
                - option
          type: basic
        - description: 'option-f: forward a word'
          conditions: *conditions_frontmost_not_whole_emacs
          from:
            key_code: f
            modifiers:
              mandatory:
                - option
          to:
            - key_code: right_arrow
              modifiers:
                - option
          type: basic
        - description: 'option-d: forward_delete a word'
          conditions: *conditions_frontmost_not_emacs
          from:
            key_code: d
            modifiers:
              mandatory:
                - option
          to:
            - key_code: right_arrow
              modifiers:
                - option
                - shift
            - key_code: delete_or_backspace
          type: basic
        - description: 'option-h: delete a word'
          from:
            key_code: h
            modifiers:
              mandatory:
                - option
          to:
            - key_code: left_arrow
              modifiers:
                - option
                - shift
            - key_code: delete_or_backspace
          type: basic
        # Application
        # Common
        - description: 'command-control-d: page_down'
          from:
              key_code: d
              modifiers: *modifiers_filter_control_command
          to:
            - key_code: page_down
          type: basic
        - description: 'command-control-u: page_up'
          from:
              key_code: u
              modifiers: *modifiers_filter_control_command
          to:
            - key_code: page_up
          type: basic
        - description: 'command-semicolon: f6(Firefox)'
          conditions:
            - bundle_identifiers:
                - '^org\.mozilla\.firefox.*'
              type: frontmost_application_if
          from:
            key_code: semicolon
            modifiers:
              mandatory:
                - command
          to:
            - key_code: f6
          type: basic

      # Layer 1
        - description: 'space: space, layer 1(option control)'
          conditions:

            - *cond_layer0
          from:
            key_code: spacebar
            modifiers: *modifiers_filter_any
          to:
            - set_variable:
                name: layer
                value: 1
          to_after_key_up:
            - set_variable:
                name: layer
                value: 0
          to_if_alone:
            - key_code: spacebar
          type: basic
        # layout 1(switch input source)
        # input source array: ja en zh
          # switch to EN
        - description: '1.a'
          conditions:
            - *cond_layer1
            - *cond_input_en
          from:
            key_code: a
            modifiers: *modifiers_filter_any
          to:
            - key_code: vk_none
          type: basic
        - description: '1.a'
          conditions:
            - *cond_layer1
            - *cond_input_ja
          from:
            key_code: a
            modifiers: *modifiers_filter_any
          to:
            - key_code: f18
          type: basic
        - description: '1.a'
          conditions:
            - *cond_layer1
            - *cond_input_zh
          from:
            key_code: a
            modifiers: *modifiers_filter_any
          to:
            - key_code: f18
            - key_code: f18
          type: basic
          # switch to ZH
        - description: '1.s'
          conditions:
            - *cond_layer1
            - *cond_input_ja
          from:
            key_code: s
            modifiers: *modifiers_filter_any
          to:
            - key_code: f18
            - key_code: f18
          type: basic 
        - description: '1.s'
          conditions:
            - *cond_layer1
            - *cond_input_zh
          from:
            key_code: s
            modifiers: *modifiers_filter_any
          to:
            - key_code: vk_none
          type: basic 
        - description: '1.s'
          conditions:
            - *cond_layer1
            - *cond_input_en
          from:
            key_code: s
            modifiers: *modifiers_filter_any
          to:
            - key_code: f18
          type: basic 
          # switch to JA
        - description: '1.d'
          conditions:
            - *cond_layer1
            - *cond_input_zh
          from:
            key_code: d
            modifiers: *modifiers_filter_any
          to:
            - key_code: f18
          type: basic 
        - description: '1.d'
          conditions:
            - *cond_layer1
            - *cond_input_en
          from:
            key_code: d
            modifiers: *modifiers_filter_any
          to:
            - key_code: f18
            - key_code: f18
          type: basic 
        - description: '1.d'
          conditions:
            - *cond_layer1
            - *cond_input_ja
          from:
            key_code: d
            modifiers: *modifiers_filter_any
          to:
          - key_code: vk_none
          type: basic 

        # layout 2(generated)
        - description: '1.b'
          conditions:
            - *cond_layer1
          from:
            key_code: b
            modifiers: *modifiers_filter_any
          to:
            - key_code: b
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.c'
          conditions:
            - *cond_layer1
          from:
            key_code: c
            modifiers: *modifiers_filter_any
          to:
            - key_code: c
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.e'
          conditions:
            - *cond_layer1
          from:
            key_code: e
            modifiers: *modifiers_filter_any
          to:
            - key_code: e
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.f'
          conditions:
            - *cond_layer1
          from:
            key_code: f
            modifiers: *modifiers_filter_any
          to:
            - key_code: f
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.g'
          conditions:
            - *cond_layer1
          from:
            key_code: g
            modifiers: *modifiers_filter_any
          to:
            - key_code: g
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.h'
          conditions:
            - *cond_layer1
          from:
            key_code: h
            modifiers: *modifiers_filter_any
          to:
            - key_code: h
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.i'
          conditions:
            - *cond_layer1
          from:
            key_code: i
            modifiers: *modifiers_filter_any
          to:
            - key_code: i
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.j'
          conditions:
            - *cond_layer1
          from:
            key_code: j
            modifiers: *modifiers_filter_any
          to:
            - key_code: j
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.k'
          conditions:
            - *cond_layer1
          from:
            key_code: k
            modifiers: *modifiers_filter_any
          to:
            - key_code: k
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.l'
          conditions:
            - *cond_layer1
          from:
            key_code: l
            modifiers: *modifiers_filter_any
          to:
            - key_code: l
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.m'
          conditions:
            - *cond_layer1
          from:
            key_code: m
            modifiers: *modifiers_filter_any
          to:
            - key_code: m
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.n'
          conditions:
            - *cond_layer1
          from:
            key_code: n
            modifiers: *modifiers_filter_any
          to:
            - key_code: n
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.o'
          conditions:
            - *cond_layer1
          from:
            key_code: o
            modifiers: *modifiers_filter_any
          to:
            - key_code: o
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.p'
          conditions:
            - *cond_layer1
          from:
            key_code: p
            modifiers: *modifiers_filter_any
          to:
            - key_code: p
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.q'
          conditions:
            - *cond_layer1
          from:
            key_code: q
            modifiers: *modifiers_filter_any
          to:
            - key_code: q
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.r'
          conditions:
            - *cond_layer1
          from:
            key_code: r
            modifiers: *modifiers_filter_any
          to:
            - key_code: r
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.t'
          conditions:
            - *cond_layer1
          from:
            key_code: t
            modifiers: *modifiers_filter_any
          to:
            - key_code: t
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.u'
          conditions:
            - *cond_layer1
          from:
            key_code: u
            modifiers: *modifiers_filter_any
          to:
            - key_code: u
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.v'
          conditions:
            - *cond_layer1
          from:
            key_code: v
            modifiers: *modifiers_filter_any
          to:
            - key_code: v
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.w'
          conditions:
            - *cond_layer1
          from:
            key_code: w
            modifiers: *modifiers_filter_any
          to:
            - key_code: w
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.x'
          conditions:
            - *cond_layer1
          from:
            key_code: x
            modifiers: *modifiers_filter_any
          to:
            - key_code: x
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.y'
          conditions:
            - *cond_layer1
          from:
            key_code: y
            modifiers: *modifiers_filter_any
          to:
            - key_code: y
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.z'
          conditions:
            - *cond_layer1
          from:
            key_code: z
            modifiers: *modifiers_filter_any
          to:
            - key_code: z
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.0'
          conditions:
            - *cond_layer1
          from:
            key_code: "0"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "0"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.1'
          conditions:
            - *cond_layer1
          from:
            key_code: "1"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "1"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.2'
          conditions:
            - *cond_layer1
          from:
            key_code: "2"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "2"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.3'
          conditions:
            - *cond_layer1
          from:
            key_code: "3"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "3"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.4'
          conditions:
            - *cond_layer1
          from:
            key_code: "4"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "4"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.5'
          conditions:
            - *cond_layer1
          from:
            key_code: "5"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "5"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.6'
          conditions:
            - *cond_layer1
          from:
            key_code: "6"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "6"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.7'
          conditions:
            - *cond_layer1
          from:
            key_code: "7"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "7"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.8'
          conditions:
            - *cond_layer1
          from:
            key_code: "8"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "8"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.9'
          conditions:
            - *cond_layer1
          from:
            key_code: "9"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "9"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.comma'
          conditions:
            - *cond_layer1
          from:
            key_code: comma
            modifiers: *modifiers_filter_any
          to:
            - key_code: comma
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.period'
          conditions:
            - *cond_layer1
          from:
            key_code: period
            modifiers: *modifiers_filter_any
          to:
            - key_code: period
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.open_bracket'
          conditions:
            - *cond_layer1
          from:
            key_code: open_bracket
            modifiers: *modifiers_filter_any
          to:
            - key_code: open_bracket
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.close_bracket'
          conditions:
            - *cond_layer1
          from:
            key_code: close_bracket
            modifiers: *modifiers_filter_any
          to:
            - key_code: close_bracket
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.slash'
          conditions:
            - *cond_layer1
          from:
            key_code: slash
            modifiers: *modifiers_filter_any
          to:
            - key_code: slash
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.semicolon'
          conditions:
            - *cond_layer1
          from:
            key_code: semicolon
            modifiers: *modifiers_filter_any
          to:
            - key_code: semicolon
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.quote'
          conditions:
            - *cond_layer1
          from:
            key_code: quote
            modifiers: *modifiers_filter_any
          to:
            - key_code: quote
              modifiers: *modifiers_layer1
          type: basic 

      # Layer 2
        - description: 'tab: tab, layer2(control option)'
          conditions:
            - *cond_layer0
          from:
            key_code: tab
            modifiers: *modifiers_filter_any
          to:
            - set_variable:
                name: layer
                value: 2
          to_after_key_up:
            - set_variable:
                name: layer
                value: 0
          to_if_alone:
            - key_code: tab
          type: basic

        # layout 1(generated)
        - description: '2.a'
          conditions:
            - *cond_layer2
          from:
            key_code: a
            modifiers: *modifiers_filter_any
          to:
            - key_code: a
              modifiers: *modifiers_layer2
          type: basic

        - description: '2.b'
          conditions:
            - *cond_layer2
          from:
            key_code: b
            modifiers: *modifiers_filter_any
          to:
            - key_code: b
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.c'
          conditions:
            - *cond_layer2
          from:
            key_code: c
            modifiers: *modifiers_filter_any
          to:
            - key_code: c
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.d'
          conditions:
            - *cond_layer2
          from:
            key_code: d
            modifiers: *modifiers_filter_any
          to:
            - key_code: d
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.e'
          conditions:
            - *cond_layer2
          from:
            key_code: e
            modifiers: *modifiers_filter_any
          to:
            - key_code: e
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.f'
          conditions:
            - *cond_layer2
          from:
            key_code: f
            modifiers: *modifiers_filter_any
          to:
            - key_code: f
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.g'
          conditions:
            - *cond_layer2
          from:
            key_code: g
            modifiers: *modifiers_filter_any
          to:
            - key_code: g
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.h'
          conditions:
            - *cond_layer2
          from:
            key_code: h
            modifiers: *modifiers_filter_any
          to:
            - key_code: h
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.i'
          conditions:
            - *cond_layer2
          from:
            key_code: i
            modifiers: *modifiers_filter_any
          to:
            - key_code: i
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.j'
          conditions:
            - *cond_layer2
          from:
            key_code: j
            modifiers: *modifiers_filter_any
          to:
            - key_code: j
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.k'
          conditions:
            - *cond_layer2
          from:
            key_code: k
            modifiers: *modifiers_filter_any
          to:
            - key_code: k
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.l'
          conditions:
            - *cond_layer2
          from:
            key_code: l
            modifiers: *modifiers_filter_any
          to:
            - key_code: l
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.m'
          conditions:
            - *cond_layer2
          from:
            key_code: m
            modifiers: *modifiers_filter_any
          to:
            - key_code: m
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.n'
          conditions:
            - *cond_layer2
          from:
            key_code: n
            modifiers: *modifiers_filter_any
          to:
            - key_code: n
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.o'
          conditions:
            - *cond_layer2
          from:
            key_code: o
            modifiers: *modifiers_filter_any
          to:
            - key_code: o
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.p'
          conditions:
            - *cond_layer2
          from:
            key_code: p
            modifiers: *modifiers_filter_any
          to:
            - key_code: p
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.q'
          conditions:
            - *cond_layer2
          from:
            key_code: q
            modifiers: *modifiers_filter_any
          to:
            - key_code: q
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.r'
          conditions:
            - *cond_layer2
          from:
            key_code: r
            modifiers: *modifiers_filter_any
          to:
            - key_code: r
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.s'
          conditions:
            - *cond_layer2
          from:
            key_code: s
            modifiers: *modifiers_filter_any
          to:
            - key_code: s
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.t'
          conditions:
            - *cond_layer2
          from:
            key_code: t
            modifiers: *modifiers_filter_any
          to:
            - key_code: t
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.u'
          conditions:
            - *cond_layer2
          from:
            key_code: u
            modifiers: *modifiers_filter_any
          to:
            - key_code: u
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.v'
          conditions:
            - *cond_layer2
          from:
            key_code: v
            modifiers: *modifiers_filter_any
          to:
            - key_code: v
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.w'
          conditions:
            - *cond_layer2
          from:
            key_code: w
            modifiers: *modifiers_filter_any
          to:
            - key_code: w
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.x'
          conditions:
            - *cond_layer2
          from:
            key_code: x
            modifiers: *modifiers_filter_any
          to:
            - key_code: x
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.y'
          conditions:
            - *cond_layer2
          from:
            key_code: y
            modifiers: *modifiers_filter_any
          to:
            - key_code: y
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.z'
          conditions:
            - *cond_layer2
          from:
            key_code: z
            modifiers: *modifiers_filter_any
          to:
            - key_code: z
              modifiers: *modifiers_layer2
          type: basic 

        - description: '2.0'
          conditions:
            - *cond_layer2
          from:
            key_code: "0"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "0"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.1'
          conditions:
            - *cond_layer2
          from:
            key_code: "1"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "1"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.2'
          conditions:
            - *cond_layer2
          from:
            key_code: "2"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "2"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.3'
          conditions:
            - *cond_layer2
          from:
            key_code: "3"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "3"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.4'
          conditions:
            - *cond_layer2
          from:
            key_code: "4"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "4"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.5'
          conditions:
            - *cond_layer2
          from:
            key_code: "5"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "5"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.6'
          conditions:
            - *cond_layer2
          from:
            key_code: "6"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "6"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.7'
          conditions:
            - *cond_layer2
          from:
            key_code: "7"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "7"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.8'
          conditions:
            - *cond_layer2
          from:
            key_code: "8"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "8"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.9'
          conditions:
            - *cond_layer2
          from:
            key_code: "9"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "9"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.-'
          conditions:
            - *cond_layer2
          from:
            key_code: "hyphen"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "hyphen"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.='
          conditions:
            - *cond_layer2
          from:
            key_code: "equal_sign"
            modifiers: *modifiers_filter_any
          to:
            - key_code: "equal_sign"
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.return_or_enter'
          conditions:
            - *cond_layer2
          from:
            key_code: return_or_enter
            modifiers: *modifiers_filter_any
          to:
            - key_code: return_or_enter
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.spacebar'
          conditions:
            - *cond_layer2
          from:
            key_code: spacebar
            modifiers: *modifiers_filter_any
          to:
            - key_code: spacebar
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.comma'
          conditions:
            - *cond_layer2
          from:
            key_code: comma
            modifiers: *modifiers_filter_any
          to:
            - key_code: comma
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.period'
          conditions:
            - *cond_layer2
          from:
            key_code: period
            modifiers: *modifiers_filter_any
          to:
            - key_code: period
              modifiers: *modifiers_layer2
          type: basic 
        - description: '2.open_bracket'
          conditions:
            - *cond_layer2
          from:
            key_code: open_bracket
            modifiers: *modifiers_filter_any
          to:
            - key_code: open_bracket
              modifiers: *modifiers_layer2
          type: basic 
      # Layer 3
        - description: 'grave_accent_and_tilde: grave_accent_and_tilde, layer3(hyper)'
          conditions:
            - *cond_layer0
          from:
            key_code: grave_accent_and_tilde
            modifiers: *modifiers_filter_not_shift
          to:
            - set_variable:
                name: layer
                value: 3
          to_after_key_up:
            - set_variable:
                name: layer
                value: 0
          to_if_alone:
            - key_code: grave_accent_and_tilde
          type: basic

        # layout 1
        - description: 'l: 3.(Media Next)[Clementine]'
          conditions:
            - *cond_layer3
          from:
            key_code: l
          to:
            # - key_code: fastforward
            - key_code: "5"
              modifiers: *modifiers_layer3
          type: basic
        - description: 'k: 3.(Media Play/Pause)[Clementine]'
          conditions:
            - *cond_layer3
          from:
            key_code: k
          to:
            # - key_code: play_or_pause
            - key_code: "6"
              modifiers: *modifiers_layer3
          type: basic
        - description: 'j: 3.(Media Previous)[Clementine]'
          conditions:
            - *cond_layer3
          from:
            key_code: j
          to:
            # - key_code: rewind
            - key_code: "7"
              modifiers: *modifiers_layer3
          type: basic
        - description: 'n: 3.(Media volume down)[Clementine]'
          conditions:
            - *cond_layer3
          from:
            key_code: n
          to:
            - key_code: "8"
              modifiers: *modifiers_layer3
          type: basic
        - description: 'm: 3.(Media volume up)[Clementine]'
          conditions:
            - *cond_layer3
          from:
            key_code: m
          to:
            - key_code: "9"
              modifiers: *modifiers_layer3
          type: basic
        - description: 'u: 3.(Media update library)[Clementine]'
          conditions:
            - *cond_layer3
          from:
            key_code: u
          to:
            - key_code: u
              modifiers: *modifiers_layer3
          type: basic
        - description: 'p: 3.volume_increment'
          conditions:
            - *cond_layer3
          from:
            key_code: p
          to:
            - key_code: volume_increment
          type: basic
        - description: 'o: 3.volume_decrement'
          conditions:
            - *cond_layer3
          from:
            key_code: o
          to:
            - key_code: volume_decrement
          type: basic
        - description: 'i: 3.mute'
          conditions:
            - *cond_layer3
          from:
            key_code: i
          to:
            - key_code: mute
          type: basic

        - description: 'semicolon: 3.hyper-;(sleep computer)[BTT]'
          conditions:
            - *cond_layer3
          from:
            key_code: semicolon
          to:
            - key_code: semicolon
              modifiers: *modifiers_layer3
          type: basic
        - description: 'quote: 3.hyper-quote(sleep display)[BTT]'
          conditions:
            - *cond_layer3
          from:
            key_code: quote
          to:
            - key_code: quote
              modifiers: *modifiers_layer3
          type: basic
        - description: 'period: 3.hyper-period(show notification center)[BTT]'
          conditions:
            - *cond_layer3
          from:
            key_code: period
          to:
            - key_code: period
              modifiers: *modifiers_layer3
          type: basic


        # Layout 2
          # F1-F12 (generated)
        - description: '1: 3.f1'
          conditions:
            - *cond_layer3
          from:
            key_code: "1"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f1
          type: basic
        - description: '2: 3.f2'
          conditions:
            - *cond_layer3
          from:
            key_code: "2"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f2
          type: basic
        - description: '3: 3.f3'
          conditions:
            - *cond_layer3
          from:
            key_code: "3"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f3
          type: basic
        - description: '4: 3.f4'
          conditions:
            - *cond_layer3
          from:
            key_code: "4"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f4
          type: basic
        - description: '5: 3.f5'
          conditions:
            - *cond_layer3
          from:
            key_code: "5"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f5
          type: basic
        - description: '6: 3.f6'
          conditions:
            - *cond_layer3
          from:
            key_code: "6"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f6
          type: basic
        - description: '7: 3.f7'
          conditions:
            - *cond_layer3
          from:
            key_code: "7"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f7
          type: basic
        - description: '8: 3.f8'
          conditions:
            - *cond_layer3
          from:
            key_code: "8"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f8
          type: basic
        - description: '9: 3.f9'
          conditions:
            - *cond_layer3
          from:
            key_code: "9"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f9
          type: basic
        - description: '0: 3.f10'
          conditions:
            - *cond_layer3
          from:
            key_code: "0"
            modifiers: *modifiers_filter_any
          to:
          - key_code: f10
          type: basic
        - description: '-: 3.f11'
          conditions:
            - *cond_layer3
          from:
            key_code: hyphen
            modifiers: *modifiers_filter_any
          to:
          - key_code: f11
          type: basic
        - description: '=: 3.f12'
          conditions:
            - *cond_layer3
          from:
            key_code: equal_sign
          to:
          - key_code: f12
          type: basic
