global:
  check_for_updates_on_startup: true
  show_in_menu_bar: false
  show_profile_name_in_menu_bar: false
profiles:
- complex_modifications:
    parameters:
      basic.to_if_alone_timeout_milliseconds: 500
    rules:
      - manipulators:
        - description: 'caps_lock: escape, left_control'
          from:
            key_code: caps_lock
            modifiers: &modifiers_any
              optional:
                - any
          to:
            - key_code: left_control
          to_if_alone:
            - key_code: escape
          type: basic
        # Emacs bindings
        - description: 'control-f: right_arrow'
          conditions: &conditions_frontmost_not_partial_emacs
            - bundle_identifiers:
                - '^org\.gnu\.Emacs.*'
                - '^com\.googlecode\.iterm2.*'
                - '^com\.apple\.com\.Terminal.*'
                - '^com\.github\.atom.*'
                - '^com\.jetbrains\..*'
                - '^com\.apple\.dt\.Xcode.*'
              type: frontmost_application_unless
          from:
            key_code: f
            modifiers:
              mandatory:
                - control
          to:
            - key_code: right_arrow
          type: basic
        - description: 'control-b: left_arrow'
          conditions: *conditions_frontmost_not_partial_emacs
          from:
            key_code: b
            modifiers:
              mandatory:
                - control
          to:
            - key_code: left_arrow
          type: basic
        - description: 'control-n: down_arrow'
          conditions: &conditions_frontmost_not_whole_emacs
            - bundle_identifiers:
                - '^org\.gnu\.Emacs.*'
                - '^com\.googlecode\.iterm2.*'
                - '^com\.apple\.com\.Terminal.*'
                - '^com\.github\.atom.*'
              type: frontmost_application_unless
          from:
            key_code: n
            modifiers:
              mandatory:
                - control
          to:
            - key_code: down_arrow
          type: basic
        - description: 'control-p: up_arrow'
          conditions: *conditions_frontmost_not_whole_emacs
          from:
            key_code: p
            modifiers:
              mandatory:
                - control
          to:
            - key_code: up_arrow
          type: basic
        - description: 'control-a: begin of line'
          conditions: &conditions_frontmost_need_home_end
            - bundle_identifiers:
              - '^org\.telegram\.desktop.*'
              - '^com\.microsoft\..*'
              type: frontmost_application_if
          from:
            key_code: a
            modifiers:
              mandatory:
                - control
          to:
            - key_code: home
          type: basic
        - description: 'control-e: end'
          conditions: *conditions_frontmost_need_home_end
          from:
            key_code: e
            modifiers:
              mandatory:
                - control
          to:
            - key_code: end
          type: basic
        - description: 'control-h: delete'
          from:
            key_code: h
            modifiers:
              mandatory:
                - control
          to:
            - key_code: delete_or_backspace
          type: basic
        - description: 'control-d: delete_forward'
          conditions: *conditions_frontmost_not_partial_emacs
          from:
            key_code: d
            modifiers:
              mandatory:
                - control
          to:
            - key_code: delete_forward
          type: basic
        - description: 'control-k: kill to end'
          conditions:  *conditions_frontmost_not_whole_emacs
          from:
            key_code: k
            modifiers:
              mandatory:
                - control
          to:
            - key_code: end
              modifiers:
                - fn
                - shift
            - key_code: delete_or_backspace
          type: basic
        - description: 'option-b: back a word'
          conditions: &conditions_frontmost_not_emacs
            - bundle_identifiers:
                - '^org\.gnu\.Emacs.*'
              type: frontmost_application_unless
          from:
            key_code: b
            modifiers:
              mandatory:
                - option
          to:
            - key_code: left_arrow
              modifiers:
                - option
          type: basic
        - description: 'option-f: forward a word'
          conditions: *conditions_frontmost_not_emacs
          from:
            key_code: f
            modifiers:
              mandatory:
                - option
          to:
            - key_code: right_arrow
              modifiers:
                - option
          type: basic
        - description: 'option-d: forward_delete a word'
          conditions: *conditions_frontmost_not_emacs
          from:
            key_code: d
            modifiers:
              mandatory:
                - option
          to:
            - key_code: right_arrow
              modifiers:
                - option
                - shift
            - key_code: delete_or_backspace
          type: basic
        - description: 'option-h: delete a word'
          from:
            key_code: h
            modifiers:
              mandatory:
                - option
          to:
            - key_code: left_arrow
              modifiers:
                - option
                - shift
            - key_code: delete_or_backspace
          type: basic
        # Application
        # Common
        - description: 'command-control-d: page_down'
          from:
              key_code: d
              modifiers: &modifiers_cg
                mandatory:
                  - control
                  - command
          to:
            - key_code: page_down
          type: basic
        - description: 'command-control-u: page_up'
          from:
              key_code: u
              modifiers: &modifiers_cg
                mandatory:
                  - control
                  - command
          to:
            - key_code: page_up
          type: basic
        - description: 'command-semicolon: f6(Firefox)'
          conditions:
            - bundle_identifiers:
                - '^org\.mozilla\.firefox.*'
              type: frontmost_application_if
          from:
            key_code: semicolon
            modifiers:
              mandatory:
                - command
          to:
            - key_code: f6
          type: basic

      # Space to mec-space
        - description: 'space: mec-space'
          from:
            key_code: spacebar
          to:
            - key_code: left_command
              modifiers:
                - shift
                - option
          to_if_alone:
            - key_code: spacebar
          type: basic

      # Layer 1
        - description: 'tab: tab, layer 1(option control)'
          conditions: &conditions_layer0
            - name: layer
              type: variable_if
              value: 0
          from:
            key_code: tab
            modifiers:
              optional:
                - shift
          to:
            - set_variable:
                name: layer
                value: 1
          to_after_key_up:
            - set_variable:
                name: layer
                value: 0
          to_if_alone:
            - key_code: tab
          type: basic

      # layer 2
        - description: 'grave_accent_and_tilde: grave_accent_and_tilde, layer2(hyper)'
          conditions: *conditions_layer0
          from:
            key_code: grave_accent_and_tilde
            modifiers:
              optional:
                - control
                - command
          to:
            - set_variable:
                name: layer
                value: 2
          to_after_key_up:
            - set_variable:
                name: layer
                value: 0
          to_if_alone:
            - key_code: grave_accent_and_tilde
          type: basic

        # Layout 2
          # F1-F12
        - description: '1: 2.f1'
          conditions: &conditions_layer1
          - name: layer
            type: variable_if
            value: 2
          from:
            key_code: "1"
            modifiers: *modifiers_any
          to:
          - key_code: f1
          type: basic
        - description: '2: 2.f2'
          conditions: *conditions_layer1
          from:
            key_code: "2"
            modifiers: *modifiers_any
          to:
          - key_code: f2
          type: basic
        - description: '3: 2.f3'
          conditions: *conditions_layer1
          from:
            key_code: "3"
            modifiers: *modifiers_any
          to:
          - key_code: f3
          type: basic
        - description: '4: 2.f4'
          conditions: *conditions_layer1
          from:
            key_code: "4"
            modifiers: *modifiers_any
          to:
          - key_code: f4
          type: basic
        - description: '5: 2.f5'
          conditions: *conditions_layer1
          from:
            key_code: "5"
            modifiers: *modifiers_any
          to:
          - key_code: f5
          type: basic
        - description: '6: 2.f6'
          conditions: *conditions_layer1
          from:
            key_code: "6"
            modifiers: *modifiers_any
          to:
          - key_code: f6
          type: basic
        - description: '7: 2.f7'
          conditions: *conditions_layer1
          from:
            key_code: "7"
            modifiers: *modifiers_any
          to:
          - key_code: f7
          type: basic
        - description: '8: 2.f8'
          conditions: *conditions_layer1
          from:
            key_code: "8"
            modifiers: *modifiers_any
          to:
          - key_code: f8
          type: basic
        - description: '9: 2.f9'
          conditions: *conditions_layer1
          from:
            key_code: "9"
            modifiers: *modifiers_any
          to:
          - key_code: f9
          type: basic
        - description: '0: 2.f10'
          conditions: *conditions_layer1
          from:
            key_code: "0"
            modifiers: *modifiers_any
          to:
          - key_code: f10
          type: basic
        - description: '-: 2.f11'
          conditions: *conditions_layer1
          from:
            key_code: hyphen
            modifiers: *modifiers_any
          to:
          - key_code: f11
          type: basic
        - description: '=: 2.f12'
          conditions: *conditions_layer1
          from:
            key_code: equal_sign
          to:
          - key_code: f12
          type: basic

        - description: 'p: 2.volume_increment'
          conditions: &conditions_layer2
            - name: layer
              type: variable_if
              value: 2
          from:
            key_code: p
          to:
            - key_code: volume_increment
          type: basic
        - description: 'o: 2.volume_decrement'
          conditions: *conditions_layer2
          from:
            key_code: o
          to:
            - key_code: volume_decrement
          type: basic
        - description: 'i: 2.mute'
          conditions: *conditions_layer2
          from:
            key_code: i
          to:
            - key_code: mute
          type: basic

    # Layer 1 common layout
        - description: '1.a'
          conditions: &conditions_layer1
            - name: layer
              type: variable_if
              value: 1
          from:
            key_code: a
            modifiers: *modifiers_any
          to:
            - key_code: a
              modifiers: &modifiers_layer1
                - option
                - control
          type: basic
        - description: '1.b'
          conditions: *conditions_layer1
          from:
            key_code: b
            modifiers: *modifiers_any
          to:
            - key_code: b
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.c'
          conditions: *conditions_layer1
          from:
            key_code: c
            modifiers: *modifiers_any
          to:
            - key_code: c
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.d'
          conditions: *conditions_layer1
          from:
            key_code: d
            modifiers: *modifiers_any
          to:
            - key_code: d
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.e'
          conditions: *conditions_layer1
          from:
            key_code: e
            modifiers: *modifiers_any
          to:
            - key_code: e
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.f'
          conditions: *conditions_layer1
          from:
            key_code: f
            modifiers: *modifiers_any
          to:
            - key_code: f
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.g'
          conditions: *conditions_layer1
          from:
            key_code: g
            modifiers: *modifiers_any
          to:
            - key_code: g
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.h'
          conditions: *conditions_layer1
          from:
            key_code: h
            modifiers: *modifiers_any
          to:
            - key_code: h
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.i'
          conditions: *conditions_layer1
          from:
            key_code: i
            modifiers: *modifiers_any
          to:
            - key_code: i
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.j'
          conditions: *conditions_layer1
          from:
            key_code: j
            modifiers: *modifiers_any
          to:
            - key_code: j
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.k'
          conditions: *conditions_layer1
          from:
            key_code: k
            modifiers: *modifiers_any
          to:
            - key_code: k
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.l'
          conditions: *conditions_layer1
          from:
            key_code: l
            modifiers: *modifiers_any
          to:
            - key_code: l
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.m'
          conditions: *conditions_layer1
          from:
            key_code: m
            modifiers: *modifiers_any
          to:
            - key_code: m
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.n'
          conditions: *conditions_layer1
          from:
            key_code: n
            modifiers: *modifiers_any
          to:
            - key_code: n
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.o'
          conditions: *conditions_layer1
          from:
            key_code: o
            modifiers: *modifiers_any
          to:
            - key_code: o
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.p'
          conditions: *conditions_layer1
          from:
            key_code: p
            modifiers: *modifiers_any
          to:
            - key_code: p
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.q'
          conditions: *conditions_layer1
          from:
            key_code: q
            modifiers: *modifiers_any
          to:
            - key_code: q
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.r'
          conditions: *conditions_layer1
          from:
            key_code: r
            modifiers: *modifiers_any
          to:
            - key_code: r
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.s'
          conditions: *conditions_layer1
          from:
            key_code: s
            modifiers: *modifiers_any
          to:
            - key_code: s
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.t'
          conditions: *conditions_layer1
          from:
            key_code: t
            modifiers: *modifiers_any
          to:
            - key_code: t
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.u'
          conditions: *conditions_layer1
          from:
            key_code: u
            modifiers: *modifiers_any
          to:
            - key_code: u
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.v'
          conditions: *conditions_layer1
          from:
            key_code: v
            modifiers: *modifiers_any
          to:
            - key_code: v
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.w'
          conditions: *conditions_layer1
          from:
            key_code: w
            modifiers: *modifiers_any
          to:
            - key_code: w
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.x'
          conditions: *conditions_layer1
          from:
            key_code: x
            modifiers: *modifiers_any
          to:
            - key_code: x
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.y'
          conditions: *conditions_layer1
          from:
            key_code: y
            modifiers: *modifiers_any
          to:
            - key_code: y
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.z'
          conditions: *conditions_layer1
          from:
            key_code: z
            modifiers: *modifiers_any
          to:
            - key_code: z
              modifiers: *modifiers_layer1
          type: basic 

        - description: '1.0'
          conditions: *conditions_layer1
          from:
            key_code: "0"
            modifiers: *modifiers_any
          to:
            - key_code: "0"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.1'
          conditions: *conditions_layer1
          from:
            key_code: "1"
            modifiers: *modifiers_any
          to:
            - key_code: "1"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.2'
          conditions: *conditions_layer1
          from:
            key_code: "2"
            modifiers: *modifiers_any
          to:
            - key_code: "2"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.3'
          conditions: *conditions_layer1
          from:
            key_code: "3"
            modifiers: *modifiers_any
          to:
            - key_code: "3"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.4'
          conditions: *conditions_layer1
          from:
            key_code: "4"
            modifiers: *modifiers_any
          to:
            - key_code: "4"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.5'
          conditions: *conditions_layer1
          from:
            key_code: "5"
            modifiers: *modifiers_any
          to:
            - key_code: "5"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.6'
          conditions: *conditions_layer1
          from:
            key_code: "6"
            modifiers: *modifiers_any
          to:
            - key_code: "6"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.7'
          conditions: *conditions_layer1
          from:
            key_code: "7"
            modifiers: *modifiers_any
          to:
            - key_code: "7"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.8'
          conditions: *conditions_layer1
          from:
            key_code: "8"
            modifiers: *modifiers_any
          to:
            - key_code: "8"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.9'
          conditions: *conditions_layer1
          from:
            key_code: "9"
            modifiers: *modifiers_any
          to:
            - key_code: "9"
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.return_or_enter'
          conditions: *conditions_layer1
          from:
            key_code: return_or_enter
            modifiers: *modifiers_any
          to:
            - key_code: return_or_enter
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.spacebar'
          conditions: *conditions_layer1
          from:
            key_code: spacebar
            modifiers: *modifiers_any
          to:
            - key_code: spacebar
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.comma'
          conditions: *conditions_layer1
          from:
            key_code: comma
            modifiers: *modifiers_any
          to:
            - key_code: comma
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.period'
          conditions: *conditions_layer1
          from:
            key_code: period
            modifiers: *modifiers_any
          to:
            - key_code: period
              modifiers: *modifiers_layer1
          type: basic 
        - description: '1.open_bracket'
          conditions: *conditions_layer1
          from:
            key_code: open_bracket
            modifiers: *modifiers_any
          to:
            - key_code: open_bracket
              modifiers: *modifiers_layer1
          type: basic 

    # Layer 2 common layout
        - description: 'l: 2.hyper-l(iTunes Next)[Keyboard Maestro]'
          conditions: *conditions_layer2
          from:
            key_code: l
          to:
            - key_code: l
              modifiers: &modifiers_hyper
                - control
                - option
                - shift
                - command
          type: basic
        - description: 'k: 2.hyper-k(iTunes Play/Pause)[Keyboard Maestro]'
          conditions: *conditions_layer2
          from:
            key_code: k
          to:
            - key_code: k
              modifiers: *modifiers_hyper
          type: basic
        - description: 'j: 2.hyper-j(iTunes Previous)[Keyboard Maestro]'
          conditions: *conditions_layer2
          from:
            key_code: j
          to:
            - key_code: j
              modifiers: *modifiers_hyper
          type: basic
        - description: 'n: 2.hyper-n(iTunes volume down)[Keyboard Maestro]'
          conditions: *conditions_layer2
          from:
            key_code: n
          to:
            - key_code: n
              modifiers: *modifiers_hyper
          type: basic
        - description: 'm: 2.hyper-m(iTunes volume up)[Keyboard Maestro]'
          conditions: *conditions_layer2
          from:
            key_code: m
          to:
            - key_code: m
              modifiers: *modifiers_hyper
          type: basic
        - description: 'semicolon: 2.hyper-;(sleep computer)[BTT]'
          conditions: *conditions_layer2
          from:
            key_code: semicolon
          to:
            - key_code: semicolon
              modifiers: *modifiers_hyper
          type: basic
        - description: 'quote: 2.hyper-;(sleep computer)[BTT]'
          conditions: *conditions_layer2
          from:
            key_code: quote
          to:
            - key_code: quote
              modifiers: *modifiers_hyper
          type: basic
